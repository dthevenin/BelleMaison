var _toString=Object.prototype.toString;Object.NULL_TYPE="Null";Object.UNDEFINED_TYPE="Undefined";Object.BOOLEAN_TYPE="Boolean";Object.NUMBER_TYPE="Number";Object.STRING_TYPE="String";Object.OBJECT_TYPE="Object";Object.BOOLEAN_CLASS="[object Boolean]";Object.NUMBER_CLASS="[object Number]";Object.STRING_CLASS="[object String]";Object.ARRAY_CLASS="[object Array]";Object.OBJECT_CLASS="[object Object]";function _isElement(a){return !!(a&&a.nodeType==1);}Object.isElement=_isElement;Array.prototype.__toString__=_toString;function _isArray(a){if(!a){return false;}if(!a.__toString__){a.__toString__=_toString;}return a.__toString__()==Object.ARRAY_CLASS;}Object.isArray=_isArray;function _isFunction(a){return typeof a=="function";}Object.isFunction=_isFunction;String.prototype.__toString__=_toString;function _isString(a){var b=typeof a;if(b=="undefined"){return false;}if(b=="null"){return false;}if(b=="object"){return false;}if(!a.__toString__){a.__toString__=_toString;}return a.__toString__()==Object.STRING_CLASS;}Object.isString=_isString;Number.prototype.__toString__=_toString;function _isNumber(a){var b=typeof a;if(b=="undefined"){return false;}if(b=="null"){return false;}if(b=="object"){return false;}if(!a.__toString__){a.__toString__=_toString;}return a.__toString__()==Object.NUMBER_CLASS;}Object.isNumber=_isNumber;function _isUndefined(a){return typeof a=="undefined";}Object.isUndefined=_isUndefined;function _camelize(){var d=this.split("-"),a=d.length;if(a==1){return d[0];}var c=this.charAt(0)=="-"?d[0].charAt(0).toUpperCase()+d[0].substring(1):d[0];for(var b=1;b<a;b++){c+=d[b].charAt(0).toUpperCase()+d[b].substring(1);}return c;}String.prototype.camelize=_camelize;function _underscore(){var c="",a=this.length,d;for(var b=0;b<a;b++){d=this.charCodeAt(b);if(d>64&&d<91){c+="_"+this.charAt(b).toLowerCase();}else{c+=this.charAt(b);}}return c;}String.prototype.underscore=_underscore;function _capitalize(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase();}String.prototype.capitalize=_capitalize;function __slice(f,g,c){var b=f.length,a=new Array(b);if(!c||c>b){c=b;}if(!g||g<0||g>b){g=0;}var d=0;for(var e=g;e<c;e++){a[d++]=f[e];}return a;}function _slice(b,a){return __slice(this,b,a);}if(!Array.prototype.slice){Array.prototype.slice=_slice;}function __remove(e,d){var c=this.slice((d||e)+1||this.length);var a=e<0?this.length+e:e;this.length=a;for(var b=0;b<c.length;b++){this[a++]=c[b];}return this;}Array.prototype._remove=__remove;function _indexOf(b,c){var a=this.length;var c=c?c:0;c=(c<0)?0:c;while(c<a){if(this[c]==b){return c;}c++;}return -1;}Array.prototype.indexOf=_indexOf;function _remove(c,b){if((typeof(c)=="object")||(typeof(c)=="string")){var a=0;while(a<this.length){if(this[a]==c){this._remove(a);}else{a++;}}}else{this._remove(c,b);}return this;}Array.prototype.remove=_remove;function _removeAll(){while(this.length>0){this._remove(0);}return this;}Array.prototype.removeAll=_removeAll;function _delete(a){if(!a){return;}if(a._free){a._free();}if(a.destructor){a.destructor();}delete (a);a=null;return a;}var free=_delete;function _toAbsolute(c){if(!c){return null;}var b=0;var g=0;var e=c;while(e){var d=0;var f=0;if(e!=c){d=parseInt(e.currentStyle?e.currentStyle.borderLeftWidth:0,0);f=parseInt(e.currentStyle?e.currentStyle.borderTopWidth:0,0);d=isNaN(d)?0:d;f=isNaN(f)?0:f;}b+=e.offsetLeft-e.scrollLeft+d;g+=e.offsetTop-e.scrollTop+f;e=e.offsetParent;}var a=new Object();a.x=b;a.y=g;return a;}function object_extend(b,a){for(var c in a){b[c]=a[c];}return(b);}function object_extend_with_proto(d,b){if(!d||!b){return;}var c=__proto_list[b];if(!c){printlnConsole("Class.new: Unknown proto '"+b+"'");return;}for(var e in c){if(d[e]){continue;}d[e]=c[e];}var a=__proto_hierarchy[b];if(a){object_extend_with_proto(d,a);}return(d);}var __proto_list=new Object();var __proto_hierarchy=new Object();function class_extend(f,a){if(!f||!a){printlnConsole("Class.extend: Invalid class name parameters");return;}var d=f.underscore();var b=a.underscore();var c=__proto_list[d];var e=__proto_list[b];var h,g;if(!c){printlnConsole("Class.extend: Unknown class '"+f+"'");return;}if(!e){printlnConsole("Class.extend: Unknown class '"+a+"'");return;}__proto_hierarchy[d]=b;c.__proto__=e;}function __apply__(b,c,a){if(!b){printlnConsole(" __apply__ Object null");return;}if(!c||!Object.isFunction(b[c])){printlnConsole(" __apply__ unknown method '"+c+"'");return;}if(!a||a.length==0){return b[c]();}else{if(a.length==1){return b[c](a[0]);}else{if(a.length==2){return b[c](a[0],a[1]);}else{if(a.length==3){return b[c](a[0],a[1],a[2]);}else{if(a.length==4){return b[c](a[0],a[1],a[2],a[3]);}else{if(a.length==5){return b[c](a[0],a[1],a[2],a[3],a[4]);}else{if(a.length==6){return b[c](a[0],a[1],a[2],a[3],a[4],a[5]);}else{if(a.length==7){return b[c](a[0],a[1],a[2],a[3],a[4],a[5],a[6]);}else{printlnConsole(" __apply__ Too much parameters...");}}}}}}}}}function class_apply(){var b=arguments;var e=b[0];var f=b[1];if(!e||!Object.isString(e)||!f||!Object.isString(f)){printlnConsole("Class.apply : bad parameters.");return;}if(b.length>2){b=__slice(b,2);}else{b=null;}var c=e.underscore();var d=__proto_list[c];if(!d){printlnConsole("Class.apply : unknown prototype for class '"+e+"'");return;}while(d){if(Object.isFunction(d[f])){this.__function_to_call__=d[f];var a=__apply__(this,"__function_to_call__",b);delete this.__function_to_call__;return a;}d=d.__proto__;}printlnConsole("Class.super : unknown function '"+f+"'");}function class_new(){var a=arguments;var d=a[0];var b=d.underscore();var c=__proto_list[b];if(!c){printlnConsole("Impossible to instanciate with unknown prototype '"+b+"'");return;}var e=new Object();object_extend_with_proto(e,b);e.apply=class_apply;e.__proto__=c;if(e._constructor){if(a.length==1){e._constructor();}else{if(a.length==2){e._constructor(a[1]);}else{if(a.length==3){e._constructor(a[1],a[2]);}else{if(a.length==4){e._constructor(a[1],a[2],a[3]);}else{if(a.length==5){e._constructor(a[1],a[2],a[3],a[4]);}else{if(a.length==6){e._constructor(a[1],a[2],a[3],a[4],a[5]);}else{if(a.length==7){e._constructor(a[1],a[2],a[3],a[4],a[5],a[6]);}}}}}}}}return e;}function class_create(c,b){var a=c.underscore();__proto_list[a]=b;b.__name__=a;return new Object();}function class_add_method(e,b,d){var a=e.underscore();var c=__proto_list[a];if(!c){printlnConsole("Impossible to add method to unknown class '"+e+"'");return;}c[b]=d;}var Class=new Object();Class.extend=class_extend;Class.create=class_create;Class.addMethod=class_add_method;Class["new"]=class_new;function ABEvent(c,a,b){this.src=c;this.type=a;this.data=b;}var abobject_proto=new Object();function abobject_constructor(a){if(!Object.isString(a)){if(a&&a.id){this.id=a.id;}else{this.id=ABObject.createId();}}else{this.id=a;}ABObject._obs[this.id]=this;this.__i__=false;}abobject_proto._constructor=abobject_constructor;function _createId(){return"id_"+new Date().getTime()+""+Math.floor(Math.random()*1000);}abobject_proto.id="";abobject_proto.__i__=false;function abobject_init(){if(this.__i__){return;}this.initComponent();this.__i__=true;}abobject_proto.init=abobject_init;function abobject_initComponent(){}abobject_proto.initComponent=abobject_initComponent;function abobject_configure(a){if(typeof(a)!="object"){return;}for(var b in a){if(b=="id"||b=="node"||b=="view"){continue;}if(!b.capitalize){continue;}var c="set"+b.capitalize();if(!this[c]){continue;}this[c](a[b]);}}abobject_proto.configure=abobject_configure;function abobject_destructor(){}abobject_proto.destructor=abobject_destructor;var ABObject=Class.create("ABObject",abobject_proto);ABObject._obs=new Object();ABObject.createId=_createId;function ABHandler(a,c,b){this.spec=a;this.obj=c;this.func=b;}var abeventsource_proto=new Object();function abeventsource_constructor(a){if(!Object.isString(a)){if(a&&a.id){a=a.id;}else{a=ABObject.createId();}}this.apply("ABObject","_constructor",a);this.__bindings__=new Object();this.__node_binds__=new Object();}abeventsource_proto._constructor=abeventsource_constructor;abeventsource_proto.__bindings__=null;abeventsource_proto.__node_binds__=null;function abeventsource_destructor(){var a,e,b,d,c;for(a in this.__bindings__){e=this.__bindings__[a];if(!e){continue;}while(e.length){d=e.pop();delete (d);}delete (this.__bindings__[a]);}delete (this.__bindings__);for(a in this.__node_binds__){c=this.__node_binds__[a];if(typeof(c)=="undefined"){printlnConsole("ABObject.destructor, no bind <"+a+" exists.");continue;}for(b=0;b<c.length;b++){data=c[b];data.n.removeEventListener(event,data.h);}}delete (this.__node_binds__);this.apply("ABObject","destructor");}abeventsource_proto.destructor=abeventsource_destructor;function abeventsource_bind(a,e,c){if(!a||!e){return;}var b=new ABHandler(a,e,c),d=this.__bindings__[a];if(!d){d=new Array();this.__bindings__[a]=d;}d[d.length]=b;return b;}function abeventsource_unbind(a,e,c){var d=this.__bindings__[a],b=0,f;if(!d){return;}while(b<d.length){f=d[b];if(f.spec==a){if(f.obj==e){if(Object.isString(c)||Object.isFunction(c)){if(f.func==c){d.remove(b);delete (f);}else{b++;}}else{d.remove(b);delete (f);}}else{b++;}}else{b++;}}}abeventsource_proto.bind=abeventsource_bind;abeventsource_proto.unbind=abeventsource_unbind;function abeventsource_propagate(c,g,h){var f=this.__bindings__[c],e,a,b,d;if(!f){if(this.__parent){if(!h){h=this;}this.__parent.propagate(c,g,h);}return;}e=new ABEvent(this,c,g);if(h){e.srcTarget=h;}a=f.length;while(a--){b=f[a];if(b.func){if(!b.obj[b.func]){printlnDebug("Unknown method '"+b.func+"' in class propotype '"+b.obj.__name__+"'");return;}b.obj[b.func](e);}else{b.obj.notify(e);}}}abeventsource_proto.propagate=abeventsource_propagate;function abeventsource_propagateChanges(j,c,f){var h="data_changed",e=this.__bindings__[h],a,g,k,d;if(!e){return;}var b=new Object();b.info=c;b.data=f;a=new ABEvent(this,h,b);g=e.length;while(g--){k=e[g];if(k.obj==j){continue;}if(k.func){if(!k.obj[k.func]){printlnDebug("Unknown method '"+k.func+"' in class propotype '"+k.obj.__name__+"'");return;}k.obj[k.func](a);}else{k.obj.notify(a);}}delete (a);}abeventsource_proto.propagateChanges=abeventsource_propagateChanges;function abeventsource_notify(a){this.propagate(a.type,a.data);}abeventsource_proto.notify=abeventsource_notify;var ABEventSource=Class.create("ABEventSource",abeventsource_proto);Class.extend("ABEventSource","ABObject");var KEYBOARD=Class["new"]("ABEventSource","__KEYBOARD__");function __keyup_handler(a){if(!a){a=document.currentEvent;}KEYBOARD.propagate(a.keyCode+KEYBOARD.KEY_UP,a);}function __keydown_handler(a){if(!a){a=document.currentEvent;}KEYBOARD.propagate(a.keyCode,a);}function __init_keyboard_handler(){var a=document.getElementById("keyboard_event");if(a){a.focus();}}function KEYBOARD_bind(f,e,d,a){var c=this.abeventsource_bind(f,e,d),b=this;}KEYBOARD.abeventsource_bind=KEYBOARD.bind;KEYBOARD.bind=KEYBOARD_bind;KEYBOARD.KEY_UP=1000;KEYBOARD.ENTER=18;KEYBOARD.DBUTTON=20;KEYBOARD.RED=22;KEYBOARD.BLUE=21;KEYBOARD.GREEN=23;KEYBOARD.YELLOW=24;KEYBOARD.BACK=19;KEYBOARD.UP_ARROW=1;KEYBOARD.DOWN_ARROW=2;KEYBOARD.LEFT_ARROW=3;KEYBOARD.RIGHT_ARROW=4;KEYBOARD.ZERO=5;KEYBOARD.ONE=6;KEYBOARD.TWO=7;KEYBOARD.THREE=8;KEYBOARD.FOUR=9;KEYBOARD.FIVE=10;KEYBOARD.SIX=11;KEYBOARD.SEVEN=12;KEYBOARD.EIGHT=13;KEYBOARD.NINE=14;KEYBOARD.TEN=15;KEYBOARD.ELEVEN=16;KEYBOARD.TWELVE=14;